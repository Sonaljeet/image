Declare PtrSafe Function URLDownloadToFile Lib "urlmon" Alias "URLDownloadToFileA" ( _
    ByVal pCaller As LongPtr, _
    ByVal szURL As String, _
    ByVal szFileName As String, _
    ByVal dwReserved As LongPtr, _
    ByVal lpfnCB As LongPtr) As Long

Sub DownloadFiles()
    Dim ws As Worksheet
    Set ws = ThisWorkbook.Sheets(1) ' Adjust if needed

    Dim lastRow As Long
    lastRow = ws.Cells(ws.Rows.Count, "A").End(xlUp).Row

    Dim lastCol As Long
    lastCol = ws.Cells(1, ws.Columns.Count).End(xlToLeft).Column

    Dim downloadPath As String
    downloadPath = Environ("USERPROFILE") & "\Downloads\"

    Dim i As Long
    Dim docWebURL As String, sharepointURL As String
    Dim docWebFile As String, sharepointFile As String
    Dim result As Long

    For i = 2 To lastRow
        docWebURL = Trim(ws.Cells(i, lastCol - 1).Value)
        sharepointURL = Trim(ws.Cells(i, lastCol).Value)

        If docWebURL <> "" Then
            docWebFile = downloadPath & "DocWeb" & Format(i - 1, "00")
            ' Assume PDF or Word, check URL or add logic to determine extension
            docWebFile = docWebFile & IIf(InStr(docWebURL, "pdf") > 0, ".pdf", ".docx")
            result = URLDownloadToFile(0, docWebURL, docWebFile, 0, 0)
        End If

        If sharepointURL <> "" Then
            sharepointFile = downloadPath & "Sharepoint" & Format(i - 1, "00")
            sharepointFile = sharepointFile & Right(sharepointURL, Len(sharepointURL) - InStrRev(sharepointURL, ".") + 1)
            result = URLDownloadToFile(0, sharepointURL, sharepointFile, 0, 0)
        End If
    Next i

    MsgBox "Download complete!"
End Sub
